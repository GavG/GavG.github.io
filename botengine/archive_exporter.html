<html>

<head>
  <title>Botengine Archive Exporter</title>

</head>

<body>
  <form onsubmit='main(); return false;'>
    <label for='token'>DEVELOPER_ACCESS_TOKEN</label>
    <input type='text' id='token' name='token'></input>
    <button type='submit'>Export to CSV</button>
  </form>

  <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous" /></script>

  <script type='text/javascript'>
    function main() {
      var token = $('#token').val();

      if (!token) {
        return alert('The DEVELOPER_ACCESS_TOKEN field must be populated');
      }
      getArchiveList(token);
    }

    function getArchiveList(token) {
      $.ajax({
        url: "https://api.botengine.ai/archives",
        success: function(data, status) {
          processArchiveList(data);
        },
        error: function(xhr, textStatus, errorThrown){
           alert('request failed - '+errorThrown);
        },
        beforeSend: function(xhr, settings) { xhr.setRequestHeader('Authorization','Bearer ' + token); }
      });
    }

    function getArchive(id){
      return 'hi';
    }

    function processArchiveList(list) {
      for (i = 0; i < list.length; ++i) {
          console.log(list[i]);
      }
    }
  </script>
</body>

</html>
